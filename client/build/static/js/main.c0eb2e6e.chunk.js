(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{260:function(e,t,a){},471:function(e,t,a){"use strict";a.r(t);a(255);var n=a(0),c=a(34),o=a.n(c),r=(a(260),a(239)),s=a.n(r),i=a(8),l=function(){return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("header",{className:"sticky top-0 z-50 bg-blue-300 h-16 flex items-center",children:Object(i.jsx)(s.a,{level:4,className:"mx-8 ",children:"Book Inventory"})})})},u=a(474),d=a(1),j=a(5),b=a(81),O=a(477),m=a(90),p=a(50),x=a(480),f=a(475),h=a(70),k="CREATE_BOOK",g="CREATE_BOOK_SUCCESS",v="DELETE_BOOKS",y="DELETE_BOOKS_SUCCESS",N="UPDATE_BOOK",S="UPDATE_BOOK_SUCCESS",w="GET_BOOKS",C="GET_BOOKS_SUCCESS",E=function(e){var t=e.name,a=e.lowStockWarning;return{type:w,payload:{name:t,lowStockWarning:a}}},I=function(e){var t=e.bookId,a=e.book;return{type:N,payload:{bookId:t,book:a}}},_=a(127),B=a(249),T=a(479),D=a(478),R=a(476),P=a(481),A=["Fantasy","Sci-Fi","Mystery","Thriller","Romance"],W=[0,1,.25,3,5,12],F=a(72),L=a.n(F),U=_.a.Option,K=function(e){var t=e.open,a=e.setOpen,c=e.setBook,o=e.book,r=e.type,s=Object(n.useRef)(null),l=Object(n.useRef)(null),u=Object(h.b)(),b=Object(n.useState)(!1),m=Object(j.a)(b,2),f=m[0],g=m[1],v=Object(h.c)((function(e){return e.books})),y=Object(n.useState)(),N=Object(j.a)(y,2),S=N[0],w=N[1],C=Object(n.useState)(""),E=Object(j.a)(C,2),F=E[0],K=E[1],G=function(){return f&&!o.lowStockWarning?(B.b.error({content:"Please enter low stock units",duration:2}),!1):"create"===r&&o.lowStockWarning>o.stock?(B.b.error({content:"Low stock warning cannot be higher than stock",duration:2}),!1):o.stock?o.stock<=0?(B.b.error({content:"Opening stock has to be more than 0",duration:2}),!1):o.price?o.price<=0?(B.b.error({content:"Price has to be more than 0",duration:2}),!1):o.bookName?o.bookCode?!!o.category||(B.b.error({content:"Please enter book category",duration:2}),!1):(B.b.error({content:"Please enter book code",duration:2}),!1):(B.b.error({content:"Please enter book name",duration:2}),!1):(B.b.error({content:"Please enter price",duration:2}),!1):(B.b.error({content:"Please enter opening stock",duration:2}),!1)},M=function(){if(G()){var e=new FormData;S&&e.append("file",S),Object.entries(o).forEach((function(t){var a=Object(j.a)(t,2),n=a[0],c=a[1];e.append(n,c)})),u(function(e){return{type:k,payload:e}}(e)),X()}};Object(n.useEffect)((function(){"edit"===r&&o.lowStockWarning&&g(!0)}),[o,r]);var X=function(){Y(),a(!1)},Y=function(){c({gstTaxRate:0,lowStockWarning:0,gstInclusive:!1}),g(!1),w(null),K(""),s.current&&(s.current.src="")};return Object(i.jsx)(T.a,{width:1080,destroyOnClose:!0,title:"edit"===r?"Edit book ".concat(o.bookName):"Create Book",onCancel:function(){return X()},onOk:function(){return X()},visible:t,footer:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(p.a,{type:"primary",onClick:function(){"edit"===r?function(){if(G()){var e=new FormData;S&&e.append("file",S),Object.entries(o).forEach((function(t){var a=Object(j.a)(t,2),n=a[0],c=a[1];e.append(n,c)})),u(I({bookId:o._id?o._id:"",book:e})),X()}}():M()},children:"Save"}),Object(i.jsx)(p.a,{type:"dashed",onClick:function(){"create"===r?Y():function(){var e=v.data.filter((function(e){return e._id===o._id}))[0];c(e)}()},children:"Reset"})]}),children:Object(i.jsxs)("div",{className:"h-116 sm:h-112 lg:h-104 w-full grid grid-cols-1 lg:grid-cols-2",children:[Object(i.jsxs)(D.a,{className:"m-2",title:"General details",children:[Object(i.jsx)(O.a,{className:"mx-2 text-gray-400",children:"Upload Book Image:"}),Object(i.jsx)("img",{alt:"",className:"m-2 w-48 h-48",ref:s,src:o.image&&"edit"===r?o.image:"",style:{display:o.image||S?"block":"none"}}),Object(i.jsx)("input",{ref:l,onChange:function(e){if(e.target.files&&e.target.files[0]){w(e.target.files[0]),K(e.target.files[0].name);var t=new FileReader;t.onload=function(e){s.current&&e.target&&(s.current.src=e.target.result)},t.readAsDataURL(e.target.files[0])}},type:"file",accept:"image/*",style:{display:"none"}}),F&&Object(i.jsx)(O.a,{className:"m-2",children:F}),Object(i.jsx)(p.a,{className:"m-2",onClick:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.click()},children:"Upload Image"}),Object(i.jsxs)("div",{className:"grid items-center grid-cols-3",children:[Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Book Name:"}),Object(i.jsx)(x.a,{className:"m-2 col-span-2",placeholder:"Book name",value:o.bookName,onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{bookName:e.target.value})}))}}),Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Book Code:"}),Object(i.jsx)(x.a,{className:"m-2 col-span-2",placeholder:"Book code",type:"number",value:o.bookCode,onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{bookCode:parseInt(e.target.value)})}))}}),Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Book Description:"}),Object(i.jsx)(x.a,{className:"m-2 col-span-2",placeholder:"Book description",value:o.description,onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{description:e.target.value})}))}}),Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Book Category:"}),Object(i.jsx)(_.a,{className:"m-2 col-span-2",style:{width:200},placeholder:"Category",value:o.category,onChange:function(e){c((function(t){return Object(d.a)(Object(d.a)({},t),{},{category:e})}))},children:A.map((function(e){return Object(i.jsx)(U,{value:e,children:e})}))})]})]}),Object(i.jsxs)("div",{children:[Object(i.jsx)(D.a,{className:"m-2",title:"Stock details",children:Object(i.jsxs)("div",{className:"grid items-center grid-cols-3",children:[Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Opening stock:"}),Object(i.jsx)(x.a,{required:!0,className:"m-2 col-span-2",placeholder:"Quantity",type:"number",value:o.stock,onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{stock:parseInt(e.target.value)})}))}}),Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"As of date:"}),Object(i.jsx)(R.a,{className:"m-2 col-span-2",value:L()(),format:"MM/DD/YYYY",placeholder:"As of Date"}),Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Low stock warning:"}),Object(i.jsx)("div",{className:"col-span-2",children:Object(i.jsx)(P.a,{className:"m-2",checked:o.lowStockWarning>0||f,title:"Enable low stock warning",onChange:function(e){g(e),e||c((function(e){return Object(d.a)(Object(d.a)({},e),{},{lowStockWarning:0})}))}})}),f&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1 align-baseline",children:"Low stock units:"}),Object(i.jsx)(x.a,{className:"m-2 col-span-2",placeholder:"Low stock units",type:"number",value:o.lowStockWarning,onChange:function(e){c((function(t){return Object(d.a)(Object(d.a)({},t),{},{lowStockWarning:parseInt(e.target.value)})}))}})]})]})}),Object(i.jsx)(D.a,{className:"m-2",title:"Pricing details",children:Object(i.jsxs)("div",{className:"grid items-center grid-cols-3",children:[Object(i.jsx)(O.a,{className:"m-2 col-span-3 sm:col-span-1",children:"Purchase price:"}),Object(i.jsx)(x.a,{className:"m-2 col-span-2",prefix:Object(i.jsx)("span",{children:"\u20b9"}),placeholder:"Price",type:"number",value:o.price,onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{price:parseInt(e.target.value)})}))}}),Object(i.jsx)(O.a,{className:"mx-2 col-span-3 sm:col-span-1",children:"Inclusive of tax:"}),Object(i.jsx)("div",{className:"col-span-2",children:Object(i.jsx)(P.a,{className:"m-2",checked:o.gstInclusive,title:"Inclusive of tax",onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{gstInclusive:e})}))}})}),Object(i.jsx)(O.a,{className:"mx-2 col-span-3 sm:col-span-1",children:"GST tax rate (%):"}),Object(i.jsx)(_.a,{className:"m-2 col-span-2",value:null!=o.gstTaxRate?"GST @ ".concat(o.gstTaxRate,"%"):"",placeholder:"GST tax rate (%)",onChange:function(e){return c((function(t){return Object(d.a)(Object(d.a)({},t),{},{gstTaxRate:e})}))},children:W.map((function(e){return Object(i.jsx)(U,{value:e,children:0===e?"None":"GST @ ".concat(e,"%")})}))})]})})]})]})})},G=a(482),M=a(252),X=a(159),Y=function(e){var t=e.open,a=e.setOpen,c=e.book,o=e.setBook,r=Object(h.b)(),s=Object(n.useState)(0),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Object(n.useState)(!0),m=Object(j.a)(b,2),f=m[0],k=m[1],g=function(){d(0),k(!0),o({gstTaxRate:0,lowStockWarning:0,gstInclusive:!1}),a(!1)};return Object(i.jsx)(T.a,{title:"Adjust Stock Quantity",visible:t,onCancel:function(){return g()},destroyOnClose:!0,onOk:function(){return a(!1)},footer:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(p.a,{type:"dashed",onClick:function(){return g()},children:"Cancel"}),Object(i.jsx)(p.a,{type:"primary",onClick:function(){var e=f?c.stock+u:c.stock-u;if(e<0)B.b.error({content:"You don't have enough stock",duration:2});else{var t=new FormData;t.append("stock",e),r(I({bookId:c._id,book:t})),g()}},children:"Save"})]}),children:Object(i.jsxs)("div",{className:"flex flex-col justify-center items-start",children:[Object(i.jsxs)("div",{className:"grid items-center grid-cols-2 gap-4",children:[Object(i.jsx)(O.a,{className:"col-span-1 font-semibold",children:"Book Name:"}),Object(i.jsx)(O.a,{className:"col-span-1",children:c.bookName}),Object(i.jsx)(O.a,{className:"col-span-1 font-semibold",children:"Current Stock:"}),Object(i.jsx)(O.a,{className:"col-span-1",children:c.stock})]}),Object(i.jsx)(O.a,{className:"text-gray-400 my-4",children:"Add or Reduce stock"}),Object(i.jsxs)(X.a.Group,{onChange:function(e){k(e.target.value)},value:f,children:[Object(i.jsx)(X.a,{value:!0,children:"Add (+)"}),Object(i.jsx)(X.a,{value:!1,children:"Reduce (+)"})]}),Object(i.jsx)(x.a,{className:"my-4",placeholder:"Adjust stock",value:u,type:"number",onChange:function(e){return d(parseInt(e.target.value))}}),Object(i.jsxs)("div",{className:"grid items-center grid-cols-2 gap-4",children:[Object(i.jsx)(O.a,{className:"font-semibold col-span-1",children:"Final Stock:"}),Object(i.jsx)(O.a,{className:"col-span-1",children:Number.isInteger(u)?f?c.stock+u:c.stock-u:c.stock})]})]})})},z=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({gstTaxRate:0,lowStockWarning:0,gstInclusive:!1}),r=Object(j.a)(o,2),s=r[0],l=r[1],u=Object(n.useState)(!1),k=Object(j.a)(u,2),g=k[0],y=k[1],N=Object(n.useState)(!1),S=Object(j.a)(N,2),w=S[0],C=S[1],I=Object(n.useState)(!1),_=Object(j.a)(I,2),B=_[0],T=_[1],D=Object(n.useState)(!1),R=Object(j.a)(D,2),P=R[0],A=R[1],W=Object(n.useState)([]),F=Object(j.a)(W,2),L=F[0],U=F[1],X=Object(h.c)((function(e){return e.books})),z=Object(h.b)(),Q={onChange:function(e){U(e)}},V=function(){var e="";L.forEach((function(t){return e+="".concat(t,",")})),z(function(e){return{type:v,payload:e}}(e))},J=[{dataIndex:"image",render:function(e){return e?Object(i.jsx)("img",{alt:"",className:"mx-auto",width:100,src:e}):Object(i.jsx)(b.a,{image:b.a.PRESENTED_IMAGE_SIMPLE,description:""})}},{dataIndex:"bookCode",sorter:{compare:function(e,t){return e.bookCode-t.bookCode}},title:"Book Code"},{dataIndex:"bookName",title:"Book Name",render:function(e){return Object(i.jsx)(O.a,{children:e||" - "})}},{dataIndex:"category",title:"Category"},{dataIndex:"stock",sorter:function(e,t){return e.stock-t.stock},title:"Stock Quantity",render:function(e,t){return Object(i.jsx)(O.a,{className:"my-0",children:t.stock<=t.lowStockWarning?Object(i.jsxs)("div",{className:"flex items-center",children:[Object(i.jsx)(m.a,{title:"Low stock warning",children:Object(i.jsx)(G.a,{className:"mx-2 text-yellow-500"})}),Object(i.jsx)(O.a,{className:"my-0",children:e})]}):Object(i.jsx)(O.a,{className:"my-0",children:e})})}},{dataIndex:"stock",title:"Stock Value",sorter:function(e,t){return e.stock*e.price-t.stock*t.price},render:function(e,t){return Object(i.jsxs)(O.a,{className:"my-0",children:["\u20b9",e*t.price]})}},{dataIndex:"price",sorter:function(e,t){return e.price-t.price},title:"Price",render:function(e,t){return Object(i.jsxs)(O.a,{className:"my-0",children:["\u20b9",t.gstInclusive?e:e+e*t.gstTaxRate/100]})}},{dataIndex:"_id",title:"Edit",render:function(e,t){return Object(i.jsx)(p.a,{shape:"circle",onClick:function(){l(t),y(!0)},icon:Object(i.jsx)(M.a,{})})}},{dataIndex:"data",title:"Actions",render:function(e,t){return Object(i.jsx)(p.a,{onClick:function(){l(t),A(!0)},children:"Adjust Stock"})}}];return Object(n.useEffect)((function(){z(E({name:a,lowStockWarning:B}))}),[z,B]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(K,{type:"create",book:s,setBook:l,open:w,setOpen:C}),Object(i.jsx)(K,{type:"edit",book:s,setBook:l,open:g,setOpen:y}),Object(i.jsx)(Y,{open:P,setOpen:A,book:s,setBook:l}),Object(i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),z(E({name:a,lowStockWarning:B}))},className:"d-flex flex-row mt-4",children:[Object(i.jsx)(x.a,{placeholder:"Search books by name",className:"my-2 mr-2 w-1/2",value:a,onChange:function(e){return c(e.target.value)}}),Object(i.jsx)(p.a,{onClick:function(){return z(E({name:a,lowStockWarning:B}))},className:"mx-2",icon:Object(i.jsx)("i",{className:"fa fa-search mr-2"}),children:"Search"}),Object(i.jsx)(p.a,{icon:B?Object(i.jsx)("i",{className:"fa fa-times mr-2"}):Object(i.jsx)(i.Fragment,{}),onClick:function(){return T(!B)},className:"mx-2",children:"Show Low Stock"}),Object(i.jsx)(p.a,{disabled:0===L.length,onClick:function(){return V()},type:"default",className:"mx-2",icon:Object(i.jsx)("i",{className:"fa fa-trash mr-2 text-red"}),children:"Delete Selected"}),Object(i.jsx)(p.a,{type:"primary",onClick:function(){return C(!0)},className:"m-2",icon:Object(i.jsx)("i",{className:"fa fa-plus mr-2"}),children:"Add to Inventory"})]}),Object(i.jsx)("div",{className:"pb-5",children:Object(i.jsx)(f.a,{rowSelection:Object(d.a)({type:"checkbox"},Q),style:{overflowX:"scroll"},columns:J,dataSource:X.data,loading:X.loading,size:"large",footer:function(){var e;return Object(i.jsxs)("div",{className:"text-right",children:[(null===(e=X.data)||void 0===e?void 0:e.length)||0," books"]})},pagination:{position:["bottomCenter"],pageSize:5},rowKey:"_id"})})]})},Q="/books",V=a(192),J=V.a.TabPane,q=Object(u.d)((function(e){return Object(i.jsxs)(V.a,{defaultActiveKey:window.location.pathname,centered:!0,onChange:function(t){e.history.push(t)},children:[Object(i.jsx)(J,{tab:"Home"},"/"),Object(i.jsx)(J,{tab:"Books"},Q),Object(i.jsx)(J,{tab:"Expenses",disabled:!0},"3")]})}));var H=function(){return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)(l,{}),Object(i.jsx)(q,{}),Object(i.jsx)("div",{className:"container mx-auto",children:Object(i.jsx)(u.c,{children:Object(i.jsx)(u.a,{path:Q,exact:!0,component:z})})})]})},Z=a(75),$=a(89),ee=a(251),te=a(38),ae=a.n(te),ne=a(53),ce=a(129),oe=a.n(ce),re="/api/books",se=function(e){return oe.a.post("".concat(re),e)},ie=function(e){return oe.a.delete("".concat(re,"?bookIds=").concat(e))},le=function(e){var t=e.name,a=e.lowStockWarning;return oe.a.get("".concat(re,"?name=").concat(t,"&showLowStock=").concat(a))},ue=function(e){var t=e.bookId,a=e.book;return oe.a.put("".concat(re,"/").concat(t),a)},de=ae.a.mark(me),je=ae.a.mark(pe),be=ae.a.mark(xe),Oe=ae.a.mark(fe);function me(e){var t;return ae.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(se,e.payload);case 3:return t=a.sent,B.b.success({content:"Created book '".concat(t.data.data.bookName,"'"),duration:2}),a.next=7,Object(ne.c)((n=t.data.data,{type:g,payload:n}));case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.log(a.t0);case 12:case"end":return a.stop()}var n}),de,null,[[0,9]])}function pe(e){var t;return ae.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(ue,e.payload);case 3:return t=a.sent,B.b.success({content:"Updated book successfully",duration:2}),a.next=7,Object(ne.c)((n=t.data.data,{type:S,payload:n}));case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.log(a.t0);case 12:case"end":return a.stop()}var n}),je,null,[[0,9]])}function xe(e){var t;return ae.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(le,e.payload);case 3:return t=a.sent,a.next=6,Object(ne.c)((n=t.data.data,{type:C,payload:n}));case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}var n}),be,null,[[0,8]])}function fe(e){return ae.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(ne.b)(ie,e.payload);case 3:return t.sent,B.b.success({content:"Deleted books successfully",duration:2}),t.next=7,Object(ne.c)((a=e.payload,{type:y,payload:a}));case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}var a}),Oe,null,[[0,9]])}var he=ae.a.mark(ke);function ke(){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ne.a,e.next=3,Object(ne.d)(k,me);case 3:return e.t1=e.sent,e.next=6,Object(ne.d)(w,xe);case 6:return e.t2=e.sent,e.next=9,Object(ne.d)(N,pe);case 9:return e.t3=e.sent,e.next=12,Object(ne.d)(v,fe);case 12:return e.t4=e.sent,e.t5=[e.t1,e.t2,e.t3,e.t4],e.next=16,(0,e.t0)(e.t5);case 16:case"end":return e.stop()}}),he)}var ge=a(10),ve=Object($.b)({books:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,data:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(d.a)(Object(d.a)({},e),{},{loading:!0});case C:return Object(d.a)(Object(d.a)({},e),{},{data:t.payload,loading:!1});case k:return Object(d.a)(Object(d.a)({},e),{},{loading:!0});case g:return Object(d.a)(Object(d.a)({},e),{},{data:[].concat(Object(ge.a)(e.data),[t.payload]),loading:!1});case N:return Object(d.a)(Object(d.a)({},e),{},{loading:!0});case S:var a=t.payload._id,n=t.payload;return Object(d.a)(Object(d.a)({},e),{},{data:e.data.map((function(e){return e._id===a?e=n:e})),loading:!1});case v:return Object(d.a)(Object(d.a)({},e),{},{loading:!0});case y:var c=t.payload.split(",").filter((function(e){return""!==e}));for(var o in c)e=Object(d.a)(Object(d.a)({},e),{},{data:e.data.filter((function(e){return e._id!==c[o]})),loading:!1});return e;default:return e}}}),ye=Object(ee.a)(),Ne=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):$.c)(Object($.a)(ye)),Se=Object($.d)(ve,Ne);ye.run(ke);var we=Se,Ce=Object(Z.a)();o.a.render(Object(i.jsx)(h.a,{store:we,children:Object(i.jsx)(u.b,{history:Ce,children:Object(i.jsx)(H,{})})}),document.getElementById("root"))}},[[471,1,2]]]);
//# sourceMappingURL=main.c0eb2e6e.chunk.js.map